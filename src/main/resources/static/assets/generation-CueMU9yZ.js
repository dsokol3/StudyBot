import{d as b,r as l,c as y}from"./index-mcUVKpX-.js";import{s}from"./notes-Cnf6t-Lc.js";const D=b("generation",()=>{const i=l([]),n=l(new Map),o=l(new Map),u=l(null),f=y(()=>n.value.size>0),v=y(()=>i.value.length);function w(){const r=localStorage.getItem("study-generation-history");if(r)try{const a=JSON.parse(r);i.value=a.slice(0,50)}catch{localStorage.removeItem("study-generation-history")}}function C(){localStorage.setItem("study-generation-history",JSON.stringify(i.value.slice(0,50)))}function P(r){let a=0;for(let t=0;t<Math.min(r.length,1e3);t++)a=(a<<5)-a+r.charCodeAt(t),a=a&a;return a.toString(36)}async function S(r,a,t){let m="";if(r==="flashcards"&&t?.additionalParams){const{easyCount:e,mediumCount:g,hardCount:h}=t.additionalParams;(e!==void 0||g!==void 0||h!==void 0)&&(m=`:${e||0}-${g||0}-${h||0}`)}const d=`${r}:${P(a)}${m}`;if(!t?.force&&o.value.has(d))return o.value.get(d);const c=crypto.randomUUID();n.value.set(c,{toolType:r,startTime:Date.now()}),u.value=null;try{let e;switch(r){case"summary":console.log("Generating summary with content length:",a.length),e=await s.generateSummary(a),console.log("Summary API response:",e);break;case"flashcards":t?.additionalParams?.easyCount!==void 0||t?.additionalParams?.mediumCount!==void 0||t?.additionalParams?.hardCount!==void 0?e=await s.generateFlashcards(a,void 0,{easyCount:t.additionalParams.easyCount,mediumCount:t.additionalParams.mediumCount,hardCount:t.additionalParams.hardCount}):e=await s.generateFlashcards(a);break;case"questions":e=await s.generateQuestions(a);break;case"essay-prompts":e=await s.generateEssayPrompts(a);break;case"explanations":e=await s.explainText(a);break;case"diagrams":e=await s.generateDiagram(a,t?.additionalParams?.diagramType||"concept-map");break;case"study-plan":e=await s.generateStudyPlan(t?.additionalParams?.examDate||"",a,t?.additionalParams?.hoursPerDay||2);break;default:throw new Error(`Unknown tool type: ${r}`)}return o.value.set(d,e),i.value.unshift({id:c,toolType:r,input:a.slice(0,200),result:e,createdAt:new Date().toISOString()}),C(),e}catch(e){throw u.value=e instanceof Error?e.message:"Generation failed",e}finally{n.value.delete(c)}}function k(r){return i.value.find(a=>a.toolType===r)}function p(){o.value.clear()}function I(){i.value=[],localStorage.removeItem("study-generation-history")}return w(),{history:i,activeGenerations:n,isGenerating:f,generationCount:v,lastError:u,generate:S,getFromHistory:k,clearCache:p,clearHistory:I}});export{D as u};
