import{d as I,r as u,c as y}from"./index-BpwbO6jE.js";import{s as i}from"./notes-DNIFI5MH.js";const D=I("generation",()=>{const s=u([]),n=u(new Map),o=u(new Map),d=u(null),f=y(()=>n.value.size>0),v=y(()=>s.value.length);function w(){const r=localStorage.getItem("study-generation-history");if(r)try{const a=JSON.parse(r);s.value=a.slice(0,50)}catch{localStorage.removeItem("study-generation-history")}}function C(){localStorage.setItem("study-generation-history",JSON.stringify(s.value.slice(0,50)))}function P(r){let a=0;for(let t=0;t<Math.min(r.length,1e3);t++)a=(a<<5)-a+r.charCodeAt(t),a=a&a;return a.toString(36)}async function S(r,a,t){let m="";if(r==="flashcards"&&t?.additionalParams){const{easyCount:e,mediumCount:h,hardCount:g}=t.additionalParams;(e!==void 0||h!==void 0||g!==void 0)&&(m=`:${e||0}-${h||0}-${g||0}`)}const l=`${r}:${P(a)}${m}`;if(!t?.force&&o.value.has(l))return o.value.get(l);const c=crypto.randomUUID();n.value.set(c,{toolType:r,startTime:Date.now()}),d.value=null;try{let e;switch(r){case"summary":e=await i.generateSummary(a);break;case"flashcards":t?.additionalParams?.easyCount!==void 0||t?.additionalParams?.mediumCount!==void 0||t?.additionalParams?.hardCount!==void 0?e=await i.generateFlashcards(a,void 0,{easyCount:t.additionalParams.easyCount,mediumCount:t.additionalParams.mediumCount,hardCount:t.additionalParams.hardCount}):e=await i.generateFlashcards(a);break;case"questions":e=await i.generateQuestions(a);break;case"essay-prompts":e=await i.generateEssayPrompts(a);break;case"explanations":e=await i.explainText(a);break;case"diagrams":e=await i.generateDiagram(a,t?.additionalParams?.diagramType||"concept-map");break;case"study-plan":e=await i.generateStudyPlan(t?.additionalParams?.examDate||"",a,t?.additionalParams?.hoursPerDay||2);break;default:throw new Error(`Unknown tool type: ${r}`)}return o.value.set(l,e),s.value.unshift({id:c,toolType:r,input:a.slice(0,200),result:e,createdAt:new Date().toISOString()}),C(),e}catch(e){throw d.value=e instanceof Error?e.message:"Generation failed",e}finally{n.value.delete(c)}}function k(r){return s.value.find(a=>a.toolType===r)}function b(){o.value.clear()}function p(){s.value=[],localStorage.removeItem("study-generation-history")}return w(),{history:s,activeGenerations:n,isGenerating:f,generationCount:v,lastError:d,generate:S,getFromHistory:k,clearCache:b,clearHistory:p}});export{D as u};
